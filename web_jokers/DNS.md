

## 本地DNS伺服器

在 Linux 平台上建立本機 DNS 伺服器通常涉及使用一些特定的軟體，如 BIND（Berkeley Internet Name Domain）等。 以下是一些步驟，你可以參考這些步驟在 Linux 上建立本機 DNS 伺服器：

1. **安裝 BIND:**
    - 使用你 Linux 發行版的套件管理器安裝 BIND。 在大多數發行版中，你可以使用以下指令：
      『`bash
      sudo apt-get update
      sudo apt-get install bind9 # 對於 Debian/Ubuntu
      ```

2. **配置 BIND:**
    - BIND 的設定檔通常位於 `/etc/bind/named.conf` 或類似的位置。 你需要編輯這個文件，配置網域解析的相關資訊。

3. **定義區域檔案:**
    - 在 BIND 的設定中，你需要定義區域文件，這些文件包含了 DNS 記錄。 通常，這些檔案位於 `/etc/bind` 目錄下。 你需要至少定義一個正向區域（用於 IP 位址到網域名稱的解析）和一個反向區域（用於網域名稱到 IP 位址的解析）。

4. **啟動 BIND 服務:**
    - 一旦 BIND 設定完成，你可以啟動 BIND 服務。 在大多數系統上，你可以使用以下命令：
      『`bash
      sudo service bind9 start # 對於 Debian/Ubuntu
      ```

5. **設定本地 DNS:**
    - 在你的電腦上，你需要設定本機 DNS 伺服器為你剛剛設定的 BIND 伺服器。 這可以透過編輯 `/etc/resolv.conf` 檔案來實現。

6. **測試:**
    - 使用 `nslookup` 或 `dig` 等工具測試你的本機 DNS 伺服器是否能夠正確解析網域名稱。

這只是一個基本的步驟概述，具體的步驟可能會因你所使用的 Linux 發行版和 BIND 版本而有所不同。 確保查看 BIND 的文檔以取得更詳細的指南。

### 重複設定問題

如果你在本地設定了 DNS 伺服器，它通常不會對外部網域產生影響，只有你的本機網路內的裝置才會使用你設定的本機 DNS 伺服器。 外部設備和網際網路上的網域解析不會受到你本地 DNS 伺服器的影響。

確保你的本機 DNS 伺服器配置正確，並且只在你的本機網路中提供服務。 如果你不希望外部設備使用你的本機 DNS 伺服器，確保你的路由器或網路設定不會將本機 DNS 伺服器向外部公開。 這有助於確保你的本地 DNS 伺服器只為你的區域網路提供服務。

是的，如果你想要使用自己搭建的本機 DNS 伺服器，你需要將你的裝置或網路設定中的 DNS 設定更改為你本機 DNS 伺服器的 IP 位址。 這樣，你的裝置將會使用你搭建的 DNS 伺服器進行網域解析。

如果你使用的是公共 DNS 服務（如 Google 的 8.8.8.8），你需要將 DNS 設定更改為你本地 DNS 伺服器的 IP 位址，以便裝置能夠使用你本地搭建的 DNS 服務。 這樣，你就可以在本地自訂網域解析的規則。 請注意，如果你的本機 DNS 伺服器沒有正確配置或沒有所需的記錄，可能會導致網域名稱解析失敗。

如果你將網路設定中的 DNS 配置變更為本機 DNS 伺服器的 IP 位址，而本機 DNS 伺服器沒有設定用於上網的 DNS 解析規則，那麼可能會導致裝置無法正常存取互聯網，因為它無法解析公用網域名稱。

為了解決這個問題，你可以在本機 DNS 伺服器的設定中新增上游（Upstream）DNS 伺服器，以便將未知的網域請求轉送給公共 DNS 伺服器。 這樣，本機 DNS 伺服器可以同時提供自訂解析和正常的網際網路存取。

在本機 DNS 伺服器的設定檔中，你可以找到類似這樣的設定：

```conf
forwarders {
     8.8.8.8; // 這裡可以新增其他上游 DNS 伺服器的 IP 位址
};
```

透過在 `forwarders` 部分新增上游 DNS 伺服器的 IP 位址，你就可以保證本機 DNS 伺服器在無法解析自訂網域名稱時能夠轉送請求給公用 DNS 伺服器，確保裝置正常存取網際網路。
